{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "RequireKMSEncryption-govcloud-atlas-prd",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:PutObject",
      "Resource": "arn:aws-us-gov:s3:::com.vmw.vmc.govcloud-atlas.us-gov-west-1.prd.secrets/*",
      "Condition": {
        "StringNotEquals": {
          "s3:x-amz-server-side-encryption-aws-kms-key-id": "arn:aws-us-gov:kms:us-gov-west-1:479848594279:key/c5d5557c-4864-424f-a40b-1a64b1fd00c4"
        }
      }
    },
    {
        "Sid": "DenyUnEncryptedObjectUploads-Secrets-govcloud-atlas-prd",
        "Effect": "Deny",
        "Principal": "*",
        "Action": "s3:PutObject",
        "Resource": "arn:aws-us-gov:s3:::com.vmw.vmc.govcloud-atlas.us-gov-west-1.prd.secrets/*",
        "Condition": {
            "Null": {
                "s3:x-amz-server-side-encryption": true
            }
        }
    },
    {
      "Sid": "DenyUnEncryptedInflightOperations-govcloud-atlas-prd",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:*",
      "Resource": "arn:aws-us-gov:s3:::com.vmw.vmc.govcloud-atlas.us-gov-west-1.prd.secrets/*",
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "false"
        }
      }
    },
    {
      "Sid": "Prevent-Bucket-Deletion-govcloud-atlas-prd",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:DeleteBucket",
      "Resource": "arn:aws-us-gov:s3:::com.vmw.vmc.govcloud-atlas.us-gov-west-1.prd.secrets"
    },
    {
        "Sid": "Allow-Only-PowerUser-svc.vmc-pci-auto-Access-prd",
        "Effect": "Deny",
        "Principal": "*",
        "Action": "s3:*",
        "Resource": [
           "arn:aws-us-gov:s3:::com.vmw.vmc.govcloud-atlas.us-gov-west-1.prd.secrets/*",
           "arn:aws-us-gov:s3:::com.vmw.vmc.govcloud-atlas.us-gov-west-1.prd.secrets"
        ],
        "Condition": {
            "ArnNotEquals": {
                "aws:PrincipalArn": ["arn:aws-us-gov:iam::479848594279:role/PowerUser", "arn:aws-us-gov:iam::479848594279:role/svc.vmc-govcloud-atlas-auto-prd", "arn:aws-us-gov:iam::479848594279:role/svc.vmc-govcloud-atlas-saas-s3-secrets-ro-prd"]
            }
        }
    }
  ]
}
